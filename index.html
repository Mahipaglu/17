<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maahipaglu's cutu cloud</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Indie+Flower&family=Patrick+Hand&display=swap');
        
        * { box-sizing: border-box; }
        
        body {
            font-family: 'Patrick Hand', cursive;
            background-color: #f5e6d3;
            background-image: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,.02) 2px, rgba(0,0,0,.02) 4px);
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        
        /* Custom Scrollbar for Gallery */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f5e6d3; }
        ::-webkit-scrollbar-thumb { background: #ffb3d9; border-radius: 4px; }

        .handwritten { font-family: 'Indie Flower', cursive; }
        
        .polaroid {
            background: white;
            padding: 12px;
            padding-bottom: 40px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transform: rotate(-2deg);
            transition: transform 0.3s;
        }
        .polaroid:hover { transform: rotate(0deg) scale(1.02); }
        
        .green-card {
            background: linear-gradient(135deg, #a8b899 0%, #8b9d7c 100%);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .rotating-lyrics { animation: fadeInOut 4s infinite; }
        
        @keyframes fadeInOut {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }
        
        .error-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ffb3d9 0%, #ffc9e3 100%);
            padding: 20px 40px;
            border-radius: 20px;
            border: 3px solid #ff69b4;
            box-shadow: 0 8px 16px rgba(255, 105, 180, 0.4);
            z-index: 9999;
            animation: errorFade 2s ease-in-out forwards;
            font-size: 1.2rem;
            font-weight: bold;
            color: #2d2d2d;
            pointer-events: none;
            text-align: center;
        }
        
        @keyframes errorFade {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            10% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
        }

        .hidden { display: none !important; }
        
        /* Loading Spinner */
        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #ffb3d9;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        @media (max-width: 768px) {
            .login-main-container { flex-direction: column !important; padding: 20px !important; }
            .welcome-box { position: static !important; transform: none !important; margin: 20px auto !important; max-width: 90% !important; }
            .pink-input-container { position: static !important; width: 100% !important; margin: 20px auto !important; }
            .arrow-button { position: static !important; margin: 20px auto !important; display: block !important; }
            .flower-photo { display: none !important; }
            .ghost-mascot { position: static !important; margin: 40px auto 20px !important; }
            .decorative-element { display: none !important; }
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center">

    <div id="LOGIN_MAIN" class="screen w-full h-screen flex items-center justify-center p-0 m-0">
        <div class="login-main-container relative w-full h-full" style="background: linear-gradient(to right, #f5e6d3 0%, #f5e6d3 35%, #e8d5c4 35%, #e8d5c4 100%);">
            
            <div class="decorative-element absolute top-8 left-8">
                <svg width="120" height="80" viewBox="0 0 120 80">
                    <path d="M 10 40 Q 10 10 40 10 L 80 10 Q 110 10 110 40 Q 110 70 80 70 L 40 70 Q 10 70 10 40" stroke="#ff9999" stroke-width="2" fill="none" opacity="0.6"/>
                </svg>
            </div>
            
            <div class="welcome-box absolute top-12 left-12" style="max-width: 280px;">
                <div style="position: absolute; top: -25px; right: 20px; z-index: 10;">
                    <svg width="60" height="60" viewBox="0 0 60 60">
                        <ellipse cx="20" cy="30" rx="15" ry="10" fill="#ffb3d9"/>
                        <ellipse cx="40" cy="30" rx="15" ry="10" fill="#ffb3d9"/>
                        <circle cx="30" cy="30" r="7" fill="#ff99cc"/>
                    </svg>
                </div>
                <div class="relative" style="background: rgba(240, 235, 225, 0.95); padding: 24px 32px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.15); transform: rotate(-1deg); border: 1px solid rgba(210, 180, 140, 0.3);">
                    <h1 style="font-size: 2.5rem; font-weight: bold; margin-bottom: 8px; line-height: 1.1; color: #2d2d2d;">welcome deviji</h1>
                    <p style="font-size: 1.1rem; line-height: 1.4; color: #3d3d3d;">enter the secret word<br>to unlock the<br>magical memories</p>
                </div>
            </div>

            <div class="flower-photo absolute" style="top: 52%; left: 80px;">
                <div style="background: white; padding: 12px; padding-bottom: 35px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); transform: rotate(-3deg); width: 160px;">
                    <img id="login-preview-img" src="" alt="Loading..." style="width: 136px; height: 136px; object-fit: cover; display: block; background: #eee;">
                </div>
            </div>

            <div class="pink-input-container absolute" style="top: 20%; right: 8%; width: 480px;">
                <div style="background: linear-gradient(135deg, #ffb3d9 0%, #ffc9e3 100%); border-radius: 2rem; padding: 24px 28px; box-shadow: 0 6px 12px rgba(255, 182, 193, 0.4);">
                    <div class="flex items-center gap-4" style="flex-wrap: wrap;">
                        <label style="font-size: 1.4rem; font-weight: bold; white-space: nowrap; color: #2d2d2d;">Sarvesh likes?</label>
                        <input type="text" id="ownerPassword" style="flex: 1; min-width: 150px; padding: 14px 20px; border-radius: 1.5rem; background: #fffacd; border: none; font-size: 1.1rem; outline: none; color: #2d2d2d;" placeholder="ofc you...">
                    </div>
                </div>
            </div>

            <div class="arrow-button absolute" style="top: 21.5%; right: 14%;">
                <button onclick="submitOwnerLogin()" style="width: 70px; height: 70px; border-radius: 50%; background: #8b6f47; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(0,0,0,0.2); transition: all 0.3s ease;">
                    <span style="color: white; font-size: 2rem; font-weight: bold;">‚Üí</span>
                </button>
            </div>

            <div class="ghost-mascot absolute" style="bottom: 6%; right: 5%;">
                <div class="text-center cursor-pointer" onclick="showScreen('LOGIN_STRANGER')" style="transition: transform 0.3s ease;">
                    <div style="position: relative; width: 70px; height: 85px; margin: 0 auto 6px;">
                        <div style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 65px; height: 75px; background: white; border-radius: 35px 35px 0 0; box-shadow: 0 3px 6px rgba(0,0,0,0.1);">
                            <div style="position: absolute; top: 22px; left: 16px; width: 8px; height: 8px; background: black; border-radius: 50%;"></div>
                            <div style="position: absolute; top: 22px; right: 16px; width: 8px; height: 8px; background: black; border-radius: 50%;"></div>
                            <div style="position: absolute; top: 28px; left: 8px; width: 12px; height: 6px; background: #ffb3d9; border-radius: 50%; opacity: 0.6;"></div>
                            <div style="position: absolute; top: 28px; right: 8px; width: 12px; height: 6px; background: #ffb3d9; border-radius: 50%; opacity: 0.6;"></div>
                            <div style="position: absolute; top: 40px; left: 50%; transform: translateX(-50%); width: 30px; height: 15px; border: 2.5px solid black; border-top: none; border-radius: 0 0 15px 15px;"></div>
                        </div>
                    </div>
                    <p style="font-size: 0.85rem; font-weight: 600; color: #2d2d2d; line-height: 1.2;">Stranger<br>login</p>
                </div>
            </div>
        </div>
    </div>

    <div id="LOGIN_STRANGER" class="screen hidden w-full h-screen flex items-center justify-center p-0 m-0">
        <div class="relative w-full h-full flex items-center justify-center" style="background: linear-gradient(to bottom, #f5e6d3 0%, #e8d5c4 100%);">
            <button onclick="showScreen('LOGIN_MAIN')" style="position: absolute; top: 20px; left: 20px; padding: 10px 20px; background: #8b6f47; color: white; border: none; border-radius: 20px; cursor: pointer;">‚Üê Back</button>
            <div style="text-align: center;">
                <h2 style="font-size: 2rem; color: #2d2d2d; margin-bottom: 20px;" class="handwritten">Stranger Access</h2>
                <div style="background: white; border: 6px solid #8b7fb8; border-radius: 2.5rem; padding: 22px 35px; margin-bottom: 20px;">
                    <input type="text" id="strangerCode" style="width: 100%; border: none; outline: none; font-size: 1.6rem; color: #666; background: transparent; text-align: center;" placeholder="Enter Code">
                </div>
                <button onclick="submitStrangerLogin()" style="background: #8b6f47; color: white; padding: 15px 40px; border-radius: 30px; font-size: 1.2rem; border: none; cursor: pointer;">Enter</button>
            </div>
        </div>
    </div>

    <div id="DASHBOARD" class="screen hidden w-full h-screen p-0 m-0" style="background-color: #f5e6d3; overflow-y: auto;">
        <div class="relative w-full min-h-screen p-8">
            <button onclick="showScreen('LOGIN_MAIN')" style="position: absolute; top: 20px; left: 20px; z-index: 50; padding: 8px 16px; background: #8b6f47; color: white; border-radius: 20px;">Logout</button>
            
            <div class="flex flex-wrap items-start gap-8 pt-8 px-8 justify-center" style="max-width: 1200px; margin: 0 auto;">
                
                <div style="flex-shrink: 0; width: 240px;">
                    <div class="polaroid" style="width: 200px; margin-bottom: 30px;">
                        <img id="dashboardPhoto" src="" alt="Loading..." style="width: 176px; height: 176px; object-fit: cover; display: block; background: #eee;">
                    </div>
                    <div class="bg-white/90 p-6 rounded shadow rotate-[-1deg] border border-stone-300">
                        <p class="text-lg" id="noteDisplay" style="color: #2d2d2d;">Your special memories live here... ‚ú®</p>
                    </div>
                </div>
                
                <div style="flex: 1; max-width: 650px;">
                    <div class="green-card rounded-3xl p-8 text-white mb-8" style="min-height: 220px;">
                        <div id="lyricsDisplay" class="rotating-lyrics">
                            <h3 class="text-2xl font-bold mb-4" id="songTitle">Tere Bina</h3>
                            <p class="text-base leading-relaxed" id="songLyrics">
                                Every moment with you feels like magic<br>
                                Your smile lights up my darkest days...
                            </p>
                        </div>
                    </div>
                    
                    <div class="text-center mb-8">
                        <div class="bg-white px-8 py-3 rounded-full border-2 border-black inline-block shadow">
                            <p class="text-2xl font-bold text-gray-800">Hi <span id="username">User</span> üëã</p>
                        </div>
                    </div>
                    
                    <div class="ml-auto w-fit cursor-pointer hover:scale-105 transition-transform" onclick="showScreen('GALLERY')">
                        <div class="relative w-36 h-28 bg-pink-300 rounded-lg shadow-md flex items-center justify-center">
                            <div class="absolute -top-3 left-0 w-16 h-6 bg-pink-300 rounded-t-lg"></div>
                            <p class="font-bold text-gray-700 mt-2">All Pics</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="GALLERY" class="screen hidden w-full h-screen p-8" style="background-color: #f5e6d3; overflow-y: auto;">
        <div class="max-w-4xl mx-auto">
            <div class="mb-6">
                <button onclick="showScreen('DASHBOARD')" class="bg-[#8b6f47] px-6 py-2 rounded-full text-white hover:bg-[#6b5435] transition">‚Üê Back</button>
            </div>
            
            <div id="gallery-loading" class="text-center py-10">
                <div class="loader"></div>
                <p>Decoding Memories...</p>
            </div>

            <div id="gallery-grid" class="bg-pink-100 rounded-3xl p-8 min-h-96 relative flex flex-wrap gap-6 justify-center hidden">
                </div>
        </div>
    </div>

    <script>
        const CONFIG = {
            ownerPassword: "kuchupuchu",
            strangerCode: "6000302",
            users: { owner: "kuchupuchu", stranger: "Stranger" }
        };

        // --- NAVIGATION & INIT ---
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => {
                s.classList.add('hidden');
                s.classList.remove('flex');
            });

            const target = document.getElementById(screenId);
            if (target) {
                target.classList.remove('hidden');
                if (screenId.includes('LOGIN')) target.classList.add('flex');
            }
            
            // Clear inputs
            if(screenId === 'LOGIN_MAIN') {
                document.getElementById('ownerPassword').value = '';
                document.getElementById('strangerCode').value = '';
            }

            // Trigger Gallery Load only when opening Gallery
            if(screenId === 'GALLERY') {
                loadGalleryImages();
            }
        }

        // --- IMAGE FETCHING LOGIC ---
        // This function attempts to load 1.txt, 2.txt etc until it 404s
        let galleryLoaded = false;

        async function loadGalleryImages() {
            if (galleryLoaded) return; // Don't reload if already done

            const galleryGrid = document.getElementById('gallery-grid');
            const loader = document.getElementById('gallery-loading');
            
            loader.classList.remove('hidden');
            galleryGrid.classList.add('hidden');

            let index = 1;
            let keepFetching = true;

            // Maximum safety limit of 50 photos to prevent infinite loops
            while (keepFetching && index < 50) {
                try {
                    // Try to fetch the text file from photos folder
                    const response = await fetch(`photos/${index}.txt`);
                    
                    if (!response.ok) {
                        // If file not found (404), we assume we reached the end
                        keepFetching = false;
                        break;
                    }

                    const base64Data = await response.text();
                    createGalleryItem(base64Data, index);
                    
                    // Also update the dashboard/login previews with the first image found
                    if (index === 1) {
                        updatePreviewImages(base64Data);
                    }

                    index++;
                } catch (error) {
                    console.log("Finished loading images or error:", error);
                    keepFetching = false;
                }
            }

            loader.classList.add('hidden');
            galleryGrid.classList.remove('hidden');
            galleryLoaded = true;
        }

        function createGalleryItem(base64String, index) {
            // Clean string just in case
            let cleanStr = base64String.trim();
            // Add header if missing
            if (!cleanStr.startsWith('data:image')) {
                cleanStr = `data:image/jpeg;base64,${cleanStr}`;
            }

            const wrapper = document.createElement('div');
            // Randomize rotation slightly for cute effect
            const rotate = (Math.random() * 6) - 3; 
            wrapper.className = "w-48 h-48 bg-white p-2 shadow-md transition hover:scale-110 duration-300";
            wrapper.style.transform = `rotate(${rotate}deg)`;

            const img = document.createElement('img');
            img.src = cleanStr;
            img.className = "w-full h-full object-cover";
            img.alt = `Memory ${index}`;

            wrapper.appendChild(img);
            document.getElementById('gallery-grid').appendChild(wrapper);
        }

        function updatePreviewImages(base64String) {
            let cleanStr = base64String.trim();
            if (!cleanStr.startsWith('data:image')) {
                cleanStr = `data:image/jpeg;base64,${cleanStr}`;
            }
            // Update login screen flower
            const loginImg = document.getElementById('login-preview-img');
            if(loginImg) loginImg.src = cleanStr;
            
            // Update dashboard polaroid
            const dashImg = document.getElementById('dashboardPhoto');
            if(dashImg) dashImg.src = cleanStr;
        }

        // --- AUTH LOGIC ---
        function submitOwnerLogin() {
            const input = document.getElementById('ownerPassword').value.trim().toLowerCase();
            if (input === CONFIG.ownerPassword) {
                document.getElementById('username').innerText = CONFIG.users.owner;
                showScreen('DASHBOARD');
                // Pre-fetch images in background
                loadGalleryImages(); 
            } else {
                showError("Galat jawab! üôà ");
            }
        }

        function submitStrangerLogin() {
            const input = document.getElementById('strangerCode').value.trim();
            if (input === CONFIG.strangerCode) {
                document.getElementById('username').innerText = CONFIG.users.stranger;
                showScreen('DASHBOARD');
                loadGalleryImages();
            } else {
                showError("Wrong code! üò§");
            }
        }

        function showError(message) {
            const existing = document.querySelector('.error-message');
            if (existing) existing.remove();
            const msgDiv = document.createElement('div');
            msgDiv.className = 'error-message';
            msgDiv.innerHTML = message;
            document.body.appendChild(msgDiv);
            setTimeout(() => { if (msgDiv) msgDiv.remove(); }, 2000);
        }

        document.addEventListener('DOMContentLoaded', () => {
            showScreen('LOGIN_MAIN');
            // Try to load just the first image immediately for the dashboard/login preview
            fetch('photos/1.txt')
                .then(res => {
                    if(res.ok) return res.text();
                    throw new Error('No image');
                })
                .then(data => updatePreviewImages(data))
                .catch(e => console.log("No initial image found"));
        });
    </script>
</body>
</html>

